<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Go</title>
  <meta name="description" content="JS Go">
  <meta name="author" content="Ben Grabow">

  <link rel="stylesheet" href="css/styles.css?v=1.0">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->
</head>
<body>
  <div id="game">
    <img class="grid" src="./grid_648.png"/>
  </div>
  <script src="./js/scripts.js"></script>
  <script>
    window.onload = () => {
      buildCellDivs();
      
      var game = new GoGame({
        notify: (state) => render(state)
      });

      var cellDivs = document.querySelectorAll('.cell');
      Array.prototype.forEach.call(cellDivs,  cellDiv => {
        cellDiv.addEventListener('click', () => {
          notifyGameOfClick(cellDiv.dataset.col, cellDiv.dataset.row, game);
        });
      });
    }

    const CELL_WIDTH = 36;
    const CELL_HEIGHT = 36;
    const BOARD_SIZE = 19;

    function render(state) {
      
    }

    function notifyGameOfClick(col, row, game) {
      //alert(`Click at ${col},${row}`);
      game.currentPlayerSelects(col, row);
    }

    function buildCellDivs() {
      var game = document.getElementById("game");
      for (var row=0; row < BOARD_SIZE; row++) {
        for (var col=0; col < BOARD_SIZE; col++) {
          game.appendChild(createCellAt(col, row));
        }
      }
    }

    function createCellAt(col, row) {
      var cell = document.createElement('div')
      cell.className = 'cell';
      cell.id = cellId(col, row);
      cell.dataset.col = col;
      cell.dataset.row = row;
      cell.style.left = CELL_WIDTH * col + 'px';
      cell.style.top = CELL_HEIGHT * row + 'px';
      cell.style.width = CELL_WIDTH + 'px';
      cell.style.height = CELL_HEIGHT + 'px';
      return cell;
    }

    function cellId(col, row) {
      return `cell-#{col}-#{row}`;
    }
  </script>
</body>
</html>